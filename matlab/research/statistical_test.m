
clc;
clear;
close all;

addpath(genpath('..'));

X = [4.0802
    4.2983
    4.2271
    5.7617
    4.0613
    4.2753
    4.4739
    5.4224
    4.1484
    4.7647
    4.7466
    6.2331
    4.6573
    4.2026
    4.1168
    5.5466
    3.9278
    4.3667
    4.2979
    6.4295
    4.5881
    4.6770
    4.6931
    7.6319
    3.6282
    4.3823
    4.1646
    6.5088
    5.7199
    5.4501
    5.4762
   10.0202
    4.4306
    4.3159
    4.1391
    4.5244
    4.5752
    3.9665
    3.9926
    5.4314
    4.0910
    4.0057
    3.8486
    4.3497
    4.0135
    4.2355
    4.2155
    6.8132
    6.2206
    5.9539
    5.9177
   12.2066
    5.3636
    5.3928
    5.4338
    7.8848
    4.8691
    4.7555
    4.7576
    6.3117
    4.0915
    4.1690
    4.2395
    5.2074
    4.3634
    4.5854
    4.4649
    4.8707
    6.8681
    6.9166
    6.9298
    5.1372];

n = size(X, 1)
m = 5;
t = sqrt(n)*(mean(X)-m) / sqrt(var(X))
t = abs(t);
p = tcdf(-t, n-1) + (1-tcdf(t, n-1))

N = 100000;
T = zeros(N, 1);
sigma = 10;
for i = 1:N
    X = m + sigma * randn(n, 1);
    T(i, 1) = sqrt(n)*(mean(X)-m) / sqrt(var(X));
end
t = -4:0.01:4;
f = tpdf(t, n-1);
figure();
hold on;
histogram(T, 200, 'Normalization', 'pdf');
plot(t, f, 'r');

%%

% lambda = 3;
% n = 10;
% g = 5;
% NN = 10000;
% gg = zeros(NN, 1);
% for i = 1:NN
%     N = poissrnd(lambda, [n 1]);
%     S = g*N;    
%     gg(i, 1) = (1/(n-1))*sum((S-mean(S)).^2) / mean(S);
% end
% mean(gg)
