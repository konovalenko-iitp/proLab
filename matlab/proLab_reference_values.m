
clc;
clear;

format long

ref_illum = rand(1,3)

XYZ = ref_illum .* [ ...
    0 0 0; ...
    0 0 1; ...
    0 1 0; ...
    0 1 1; ...
    1 0 0; ...
    1 0 1; ...
    1 1 0; ...
    1 1 1]

proLab = XYZ2proLab(XYZ, ref_illum) %% reference result below:
% proLab =
%    1.0e+02 *
%                    0                   0                   0
%    0.626014435842777  -0.083286585137814  -0.909832080481694
%    1.000000000000000  -1.223544158139153   0.400567131056590
%    1.000000000000000  -0.944453787936702  -0.073908722574727
%    0.430329269682124   3.518970035319585   0.275378831035661
%    0.708395299332225   1.736360190126265  -0.568454203481760
%    1.000000000000000   0.039612237637851   0.432728566346496
%    1.000000000000000  -0.000000000000000                   0

err = max(max(abs(XYZ - proLab2XYZ(proLab, ref_illum)))) % should be ~zero

format



