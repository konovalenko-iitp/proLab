
function plot_MacAd_Ell(CS_name, Y)

    if nargin == 0
        CS_name = 'CIE xyY';
    end

    angle = 2*pi*(0:0.01:1.01)';
    x = [cos(angle); 0];
    y = [sin(angle); 0];
    n = size(y, 1);
    raw_params = [...
        0.160, 0.057, 0.85, 0.35, 62.5; ...
        0.187, 0.118, 2.20, 0.55, 77.0; ...
        0.253, 0.125, 2.50, 0.50, 55.5; ...
        0.150, 0.680, 9.60, 2.30, 105.5; ...
        0.131, 0.521, 4.70, 2.00, 112.5; ...
        0.212, 0.550, 5.80, 2.30, 100.0; ...
        0.258, 0.450, 5.00, 2.00, 92.0; ...
        0.152, 0.365, 3.80, 1.90, 110.0; ...
        0.280, 0.385, 4.00, 1.50, 75.5; ...
        0.380, 0.498, 4.40, 1.20, 70.0; ...
        0.160, 0.200, 2.10, 0.95, 104.0; ...
        0.228, 0.250, 3.10, 0.90, 72.0; ...
        0.305, 0.323, 2.30, 0.90, 58.0; ...
        0.385, 0.403, 3.80, 1.60, 65.5; ...
        0.472, 0.399, 3.20, 1.40, 51.0; ...
        0.527, 0.350, 2.60, 1.30, 20.0; ...
        0.475, 0.300, 2.90, 1.10, 28.5; ...
        0.510, 0.236, 2.40, 1.20, 29.5; ...
        0.596, 0.283, 2.60, 1.30, 13.0; ...
        0.344, 0.284, 2.30, 0.90, 60.0; ...
        0.390, 0.237, 2.50, 1.00, 47.0; ...
        0.441, 0.198, 2.80, 0.95, 34.5; ...
        0.278, 0.223, 2.40, 0.55, 57.5; ...
        0.300, 0.163, 2.90, 0.60, 54.0; ...
        0.365, 0.153, 3.60, 0.95, 40.0; ...
        ];
    if ~strcmp(CS_name, 'CIE xyY') % !!!!!!! Crutch against outlayer!!!
        raw_params(1,:) = [];
    end
    CS = color_spaces_collection(CS_name);
    num_ell = size(raw_params, 1);
    XYZ = zeros(num_ell, n, 3);
    for ell = 1:num_ell
        center = raw_params(ell, 1:2)';
        sigma = raw_params(ell, 3:4)'/1000;
        theta = raw_params(ell, 5);
        R = [cosd(theta), -sind(theta); sind(theta), cosd(theta)];
        K = R*diag(sigma);
        M = [K, center; 0 0 Y];
        xyY = [x, y, ones(size(x))] * M';
        XYZ(ell, :, :) = xyY2XYZ(xyY);
    end
    XYZ = reshape(XYZ, [num_ell * n, 3]);
    CC = CS.transform_into(XYZ);
    CC = reshape(CC, [num_ell, n, 3]);
    for ell = 1:num_ell
        C = squeeze(CC(ell, :, :));
        C(1:end-1, :) = C(end, :) + 10 * (C(1:end-1, :)-C(end, :));
        AO = CS.axis_Lab_order;
        % !!!!!!! Crutch against eclipsed!!!
        C(:, abs(AO(1))) = C(:, abs(AO(1))) + 1; % !!!!!!!
        color = [0 0 0];
        if (strcmp(CS_name, 'linRGB') || strcmp(CS_name, 'sRGB'))
            if C(end, abs(AO(2))) > 0
                plot3(C(1:end-1, abs(AO(1))), C(1:end-1, abs(AO(2))), C(1:end-1, abs(AO(3))), 'LineWidth', 1, 'color', color);
                plot3(C(end, abs(AO(1))), C(end, abs(AO(2))), C(end, abs(AO(3))), '.', 'MarkerSize', 5, 'color', color);
            end
        else
            plot3(C(1:end-1, abs(AO(1))), C(1:end-1, abs(AO(2))), C(1:end-1, abs(AO(3))), 'LineWidth', 1, 'color', color);
            plot3(C(end, abs(AO(1))), C(end, abs(AO(2))), C(end, abs(AO(3))), '.', 'MarkerSize', 5, 'color', color);
        end
%         text(C(end, abs(AO(1))), C(end, abs(AO(2))), C(end, abs(AO(3))), num2str(ell));
%         if strcmp(colorSpace, 'proLab')
%             plane = (saved_proLab_matrix^(-1))' * [0; 1; 0; -Y];
%             [C(end, 1:3), 1] * plane
%         end
    end
end

